{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Bump chart of state rankings by arrivals per year",
  "title": "State Rankings by Arrivals",
  "width": 900,
  "height": 420,
  "data": { "url": "data/Arrivals by State.csv" },
  "transform": [
    { "calculate": "datum['']", "as": "State" },
    { "fold": [
      "1991","1992","1993","1994","1995","1996","1997","1998","1999",
      "2000","2001","2002","2003","2004","2005","2006","2007","2008",
      "2009","2010","2011","2012","2013","2014","2015","2016","2017",
      "2018","2019","2020","2021","2022","2023","2024","2025"
    ], "as": ["Year","Arrivals"] },
    { "calculate": "toNumber(datum.Arrivals)", "as": "ArrivalsNum" },
    { "calculate": "toNumber(datum.Year)", "as": "YearNum" },
    { "filter": "isValid(datum.ArrivalsNum) && isValid(datum.YearNum)" },
    { "window": [{ "op": "rank", "as": "Rank" }], "sort": [ { "field": "ArrivalsNum", "order": "descending" } ], "frame": [null, null], "groupby": ["YearNum"] }
  ],
  "mark": { "type": "line", "interpolate": "monotone", "point": true },
  "encoding": {
    "x": { "field": "YearNum", "type": "quantitative", "axis": { "labelAngle": 0 }, "title": "Year" },
    "y": {
      "field": "Rank",
      "type": "quantitative",
      "sort": "ascending",
      "scale": { "zero": false, "reverse": true, "domain": [1, 8] },
      "axis": { "values": [1,2,3,4,5,6,7,8] },
      "title": "Rank (1=highest arrivals)"
    },
    "color": { "field": "State", "type": "nominal", "legend": {"title": "State"} },
    "tooltip": [ { "field": "State" }, { "field": "YearNum", "title": "Year" }, { "field": "ArrivalsNum", "title": "Arrivals", "format": "," }, { "field": "Rank" } ]
  }
}
